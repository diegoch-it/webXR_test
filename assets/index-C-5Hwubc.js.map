{"version":3,"file":"index-C-5Hwubc.js","sources":["../../src/main.js"],"sourcesContent":["import * as BABYLON from \"@babylonjs/core\";\nimport \"@babylonjs/loaders\";\n\nasync function startAR() {\n    try {\n        console.log(\"Starting AR initialization...\");\n        \n        // Get canvas element - make sure this ID matches your HTML\n        const canvas = document.getElementById(\"renderCanvas\");\n        if (!canvas) {\n            throw new Error(\"Canvas element with id 'renderCanvas' not found\");\n        }\n        \n        const engine = new BABYLON.Engine(canvas, true);\n        const scene = new BABYLON.Scene(engine);\n        \n        // Set transparent background for AR\n        scene.clearColor = new BABYLON.Color4(0, 0, 0, 0);\n        \n        // Create camera\n        const camera = new BABYLON.FreeCamera(\"camera\", new BABYLON.Vector3(0, 0, 0), scene);\n        \n        // Add light to the scene\n        const light = new BABYLON.HemisphericLight(\"light\", new BABYLON.Vector3(0, 1, 0), scene);\n        light.intensity = 1;\n        \n        console.log(\"Checking WebXR support...\");\n        \n        // Check if WebXR is supported\n        const xrSupported = await BABYLON.WebXRSessionManager.IsSessionSupportedAsync('immersive-ar');\n        if (!xrSupported) {\n            throw new Error(\"WebXR AR is not supported on this device/browser\");\n        }\n        \n        console.log(\"Creating XR experience...\");\n        \n        // Create XR experience\n        const xr = await scene.createDefaultXRExperienceAsync({\n            uiOptions: {\n                sessionMode: \"immersive-ar\",\n                referenceSpaceType: \"local\"\n            },\n            optionalFeatures: true\n        });\n        \n        console.log(\"Enabling image tracking...\");\n        \n        // Enable image tracking\n        const fm = xr.baseExperience.featuresManager;\n        const imageTracking = fm.enableFeature(\n            BABYLON.WebXRFeatureName.IMAGE_TRACKING,\n            \"latest\",\n            {\n                images: [\n                    {\n                        src: \"./card-image.png\", // Updated to match your actual file\n                        estimatedRealWorldWidth: 0.2 // 20cm width - adjust based on your actual image size\n                    }\n                ]\n            }\n        );\n        \n        let modelMesh = null;\n        let anchorFound = false;\n        \n        console.log(\"Loading 3D model...\");\n        \n        // Load the 3D model\n        try {\n            const result = await BABYLON.SceneLoader.ImportMeshAsync(\n                \"\",\n                \"./\", \n                \"model.glb\", // Updated to match your actual file\n                scene\n            );\n            \n            modelMesh = result.meshes[0];\n            modelMesh.setEnabled(false); // Hide initially\n            \n            console.log(\"Model loaded successfully\");\n        } catch (modelError) {\n            console.error(\"Error loading model:\", modelError);\n            throw new Error(\"Failed to load 3D model: \" + modelError.message);\n        }\n        \n        // Simple \"floating\" animation\n        scene.onBeforeRenderObservable.add(() => {\n            if (anchorFound && modelMesh) {\n                modelMesh.position.y += Math.sin(performance.now() * 0.002) * 0.01;\n            }\n        });\n        \n        // Image tracking event handler\n        imageTracking.onTrackedImageUpdatedObservable.add((image) => {\n            if (!modelMesh) return;\n            \n            console.log(\"Image tracking state:\", image.trackingState);\n            \n            if (image.trackingState === 'tracked') {\n                modelMesh.setEnabled(true);\n                anchorFound = true;\n                \n                // Get transformation from the tracked image\n                const matrix = image.transformationMatrix;\n                const position = new BABYLON.Vector3();\n                const rotation = new BABYLON.Quaternion();\n                const scale = new BABYLON.Vector3();\n                \n                matrix.decompose(scale, rotation, position);\n                \n                // Apply position and rotation\n                modelMesh.position = position;\n                modelMesh.rotationQuaternion = rotation;\n                \n                // Set appropriate scale for your model\n                modelMesh.scaling.setAll(0.1); // Adjust this value based on your model size\n            } else {\n                // Hide model when tracking is lost\n                modelMesh.setEnabled(false);\n                anchorFound = false;\n            }\n        });\n        \n        // Tap interaction: rotate the model\n        scene.onPointerObservable.add((pointerInfo) => {\n            if (!anchorFound || !modelMesh) return;\n            \n            if (pointerInfo.type === BABYLON.PointerEventTypes.POINTERDOWN) {\n                const pickResult = scene.pick(\n                    scene.pointerX, \n                    scene.pointerY\n                );\n                \n                if (pickResult.hit && pickResult.pickedMesh === modelMesh) {\n                    modelMesh.rotation.y += 0.4;\n                    console.log(\"Model rotated\");\n                }\n            }\n        });\n        \n        // Start render loop\n        engine.runRenderLoop(() => {\n            scene.render();\n        });\n        \n        // Handle window resize\n        window.addEventListener(\"resize\", () => {\n            engine.resize();\n        });\n        \n        console.log(\"AR initialization complete\");\n        \n    } catch (error) {\n        console.error(\"AR initialization failed:\", error);\n        showError(error.message);\n    }\n}\n\n// Error display function\nfunction showError(message) {\n    const errorDiv = document.createElement('div');\n    errorDiv.style.cssText = `\n        position: fixed;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        background: rgba(255, 0, 0, 0.9);\n        color: white;\n        padding: 20px;\n        border-radius: 10px;\n        font-family: Arial, sans-serif;\n        z-index: 10000;\n        max-width: 80%;\n        text-align: center;\n    `;\n    errorDiv.innerHTML = `\n        <h3>AR Initialization Error</h3>\n        <p>${message}</p>\n        <p style=\"font-size: 0.9em; margin-top: 10px;\">\n            Check the browser console for more details (F12)\n        </p>\n    `;\n    document.body.appendChild(errorDiv);\n}\n\n// Start AR when page is loaded\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', startAR);\n} else {\n    startAR();\n}\n"],"names":["startAR","canvas","engine","BABYLON.Engine","scene","BABYLON.Scene","BABYLON.Color4","camera","BABYLON.FreeCamera","BABYLON.Vector3","light","BABYLON.HemisphericLight","BABYLON.WebXRSessionManager","xr","imageTracking","BABYLON.WebXRFeatureName","modelMesh","anchorFound","BABYLON.SceneLoader","modelError","image","matrix","position","rotation","BABYLON.Quaternion","scale","pointerInfo","BABYLON.PointerEventTypes","pickResult","error","showError","message","errorDiv"],"mappings":"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"}