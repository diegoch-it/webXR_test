import{E as h,S as y,C as p,F as w,V as u,H as E,a as v,W as m,M,b as R,c as L,P as T}from"./babylon-3sb16Gpf.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))f(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const r of e.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&f(r)}).observe(document,{childList:!0,subtree:!0});function t(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerPolicy&&(e.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?e.credentials="include":o.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function f(o){if(o.ep)return;o.ep=!0;const e=t(o);fetch(o.href,e)}})();async function b(){try{document.readyState!=="complete"&&await new Promise(a=>window.addEventListener("load",a));const i=document.getElementById("canvas");if(!i)throw new Error("Canvas element not found");i.width=window.innerWidth,i.height=window.innerHeight;const s=new h(i,!0,{preserveDrawingBuffer:!0,stencil:!0,disableWebGL2Support:!1,audioEngine:!1});window.addEventListener("resize",()=>{s.resize()});const t=new y(s);t.clearColor=new p(0,0,0,0),new w("camera",u.Zero(),t).attachControl(i,!0);const o=new E("light",new u(0,1,0),t);o.intensity=1;let e=null,r=!1;try{console.log("Loading 3D model..."),e=(await v.ImportMeshAsync("","./","arm_chair__furniture.glb",t)).meshes[0],e.setEnabled(!1),console.log("Model loaded successfully")}catch(a){console.error("Error loading model:",a)}s.runRenderLoop(()=>{t.render()}),console.log("Initializing WebXR...");try{const a=await t.createDefaultXRExperienceAsync({uiOptions:{sessionMode:"immersive-ar",referenceSpaceType:"unbounded"},optionalFeatures:!0});a.baseExperience.sessionManager.onXRSessionInit.add(()=>{console.log("AR Session started!");const g=a.baseExperience.featuresManager;try{const l=g.enableFeature(m.IMAGE_TRACKING,"latest",{images:[{src:"./furniture.jpg",estimatedRealWorldWidth:.085}]},!1,!1);l&&(console.log("Image tracking enabled"),l.onTrackedImageUpdatedObservable.add(n=>{if(!e)return;const c=n.realWorldTransform;c&&(e.setEnabled(!0),r=!0,e.position.copyFrom(c.position),e.rotationQuaternion=c.rotationQuaternion,e.scaling.setAll(.1),console.log("Image tracked!"))}))}catch{console.log("Image tracking not available")}try{const l=g.enableFeature(m.HIT_TEST,"latest",{offsetRay:{origin:{x:0,y:0,z:0},direction:{x:0,y:0,z:-1}}},!1,!1);if(l){console.log("Hit-test enabled");const n=M.CreateTorus("indicator",{diameter:.15,thickness:.01},t),c=new R("indicatorMat",t);c.emissiveColor=new L(0,1,0),n.material=c,n.isVisible=!1,l.onHitTestResultObservable.add(d=>{d.length>0?(n.isVisible=!0,n.position=d[0].position,n.rotationQuaternion=d[0].rotationQuaternion):n.isVisible=!1});const O=t.onPointerObservable.add(d=>{d.type===T.POINTERDOWN&&(!r&&n.isVisible&&e?(e.setEnabled(!0),e.position=n.position.clone(),e.rotationQuaternion=n.rotationQuaternion.clone(),e.scaling.setAll(.1),r=!0,n.isVisible=!1,console.log("Model placed!")):r&&e&&(e.rotation.y+=.4))})}}catch{console.log("Hit-test not available"),e&&setTimeout(()=>{r||(e.setEnabled(!0),e.position=new u(0,-.5,-2),e.scaling.setAll(.1),r=!0,console.log("Model placed at fixed position"))},2e3)}}),console.log("WebXR initialized successfully")}catch(a){console.error("WebXR not available:",a),e&&(e.setEnabled(!0),e.position=new u(0,0,5),e.scaling.setAll(1),t.clearColor=new p(.2,.2,.2,1))}t.registerBeforeRender(()=>{r&&e&&(e.position.y+=Math.sin(performance.now()*.002)*.001)}),console.log("AR initialization complete")}catch(i){console.error("Fatal error:",i),document.body.innerHTML=`
            <div style="padding: 20px; color: red;">
                <h2>Error</h2>
                <p>${i.message}</p>
                <p>Check console for details</p>
            </div>
        `}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",b):b();
//# sourceMappingURL=index-xUbUI5G4.js.map
